name: Build and Test

on:
  pull_request:
    branches: [main]
    types: [opened, synchronize, reopened]

jobs:
	build-and-test:
		runs-on: ${{ matrix.os }}
		strategy:
			matrix:
				os: [ubuntu-latest, windows-latest]

		steps:
			- name: Checkout repository
				uses: actions/checkout@v4
				with:
					submodules: recursive

			- name: Set up Ninja
				uses: ashutoshvarma/action-ninja@v1.1

			- name: Set up CMake
				uses: jwlawson/actions-setup-cmake@v1

			- name: Configure
				run: cmake -S . -B build -G Ninja

			- name: Build
				run: cmake --build build

			- name: Test
				run: ctest --test-dir build --output-on-failure
